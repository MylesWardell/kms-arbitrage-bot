import{a as P,b as Ue,c as $e,d as Fe}from"./chunk-DW66PHBU.js";import{a as oe,b as Be,c as De,d as X,e as Ne,f as Je}from"./chunk-KMLVHYGH.js";import{a as Ce,b as Te,c as Le,d as ee,e as J}from"./chunk-4TG7HONN.js";import"./chunk-6QOSJNPS.js";import{a as _e}from"./chunk-MNS7ISQU.js";import{b as E}from"./chunk-GGM2I3UO.js";import{b as j,d as G,e as he}from"./chunk-J3XWRTOX.js";import{a as de,b as W,d as M,e as Ie,f as I,g as re}from"./chunk-6QUXFABH.js";import{a as e,b as ue,c as ve,d as T}from"./chunk-TJ55WERY.js";import{c as $}from"./chunk-442635WZ.js";import{a as Ee,b as _,h as c,i as O,j as ae}from"./chunk-A24ONYSU.js";import{d as C}from"./chunk-4C7GSA6N.js";import"./chunk-JG7V63GM.js";var Ir=new TextEncoder,Ur="Deno"in globalThis&&typeof Deno.KvU64=="function";function ke(r){let t=ArrayBuffer.isView(r)?new Uint8Array(r.buffer):new Uint8Array(r),a=[],n=0;for(;t.byteLength>n;)a.push(ue(t.subarray(n,n+he))),n+=he;return a}async function ce(r){return new Uint8Array,r instanceof File?{meta:{kind:"file",type:r.type,lastModified:r.lastModified,name:r.name},parts:ke(await r.arrayBuffer())}:r instanceof Blob?{meta:{kind:"blob",type:r.type},parts:ke(await r.arrayBuffer())}:{meta:{kind:"buffer"},parts:ke(r)}}function pe(r){try{return ve(r).byteLength}catch{return 0}}function ie(r,t){switch(r){case"string":case"bigint":return{type:r,value:t};case"Uint8Array":return{type:r,value:t,byteLength:pe(t)};case"number":{let a=parseFloat(t);return{type:r,value:Number.isNaN(a)?"NaN":a===1/0?"Infinity":a===-1/0?"-Infinity":a}}case"boolean":return{type:r,value:t==="true"};default:throw new TypeError(`Unexpected type: "${r}"`)}}async function ye(r,t,a){if(a)switch(r){case"buffer":return ce(await a.arrayBuffer());case"Blob":return ce(new Blob([a],{type:a.type}));case"File":return ce(a)}if(t)switch(r){case"string":case"number":case"bigint":case"boolean":case"Uint8Array":return ie(r,t);case"null":return{type:r,value:null};case"Map":{let n=JSON.parse(t);return T(Array.isArray(n),"Expected an array."),j(new Map(n))}case"Set":{let n=JSON.parse(t);return T(Array.isArray(n),"Expected an array."),j(new Set(n))}case"Array":{let n=JSON.parse(t);return T(Array.isArray(n),"Expected an array."),{type:r,value:n.map(j)}}case"object":{let n=JSON.parse(t);return T(typeof n=="object"&&n!==null,"Expected an object."),{type:r,value:Object.fromEntries(Object.entries(n).map(([o,d])=>[o,j(d)]))}}case"RegExp":case"Date":case"KvU64":return{type:r,value:t};case"ArrayBuffer":case"Int8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":case"DataView":return{type:r,value:t,byteLength:pe(t)};default:throw new TypeError(`Unexpected type: "${r}"`)}throw new TypeError("Unexpected form data.")}function Re(){let r=c("string"),t=O(()=>{switch(r.value){case"bigint":return e("input",{type:"number",name:"key_part",id:"key_part",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 invalid:border-red-700",placeholder:"Key part value",required:!0});case"number":return e("input",{type:"text",name:"key_part",id:"key_part",pattern:"-?\\d+(\\.\\d+)?|-?Infinity|NaN",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 invalid:border-red-700",placeholder:"Key part value",required:!0});case"boolean":return e("select",{name:"key_part",id:"key_part",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",children:[e("option",{selected:!0,value:"true",children:"true"}),e("option",{value:"false",children:"false"})]});default:return e("input",{type:"text",name:"key_part",id:"key_part",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Key part value",required:!0})}});return e(C,{children:[e("div",{children:[e(re,{for:"key_part",children:"Key Part"}),t]}),e("div",{children:[e(re,{for:"key_part_type",children:"Key Part Type"}),e("select",{id:"key_part_type",name:"key_part_type",value:r,onChange:a=>r.value=a.currentTarget.value,class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",children:[e("option",{selected:!0,value:"string",children:"String"}),e("option",{value:"number",children:"Number"}),e("option",{value:"bigint",children:"BigInt"}),e("option",{value:"boolean",children:"Boolean"}),e("option",{value:"Uint8Array",children:"Uint8Array"})]})]})]})}var Ve=100,lr=3e3,je=/[^a-z0-9]([a-z0-9]+)$/i,xe=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),ur=/Win/i.test(navigator.platform);function Z(r,t){return r.substring(0,t).split(`
`)}function dr({value:r}){return e("pre",{"aria-hidden":"true",...typeof r.value=="string"?{dangerouslySetInnerHTML:{__html:`${r.value}<br />`}}:{children:r},class:"editArea highlight"})}function He({value:r="",highlight:t,insertSpaces:a=!0,ignoreTabKey:n=!1,class:o="",tabSize:d=2,autofocus:s,autoFocus:g,disabled:u,form:l,maxlength:p,maxLength:f,name:y,id:v,placeholder:h,readonly:K,readOnly:B,required:D,rows:H,onKeyDown:w,...L}){let le={autoFocus:g,autofocus:s,disabled:u,form:l,maxLength:f,maxlength:p,name:y,id:v,placeholder:h,readOnly:B,readonly:K,required:D,rows:H},Y=Ie(r),te=O(()=>t(Y.value??"")),U=c(!1),S=(a?" ":"	").repeat(d),A=c([]),N=c(-1),R=_(null);Ee(()=>{if(!R.current)return;let{value:i,selectionStart:m,selectionEnd:b}=R.current;me({value:i,selectionStart:m,selectionEnd:b})});function me(i,m=!1){if(A.value.length&&N.value>-1){A.value=A.value.slice(0,N.value+1);let x=A.value.length;if(x>Ve){let k=x-Ve;A.value=A.value.slice(k,x),N.value=Math.max(N.value-k,0)}}let b=Date.now();if(m){let x=A.value[N.value];if(x&&b-x.timestamp<lr){let k=Z(x.value,x.selectionStart).pop()?.match(je),F=Z(i.value,i.selectionStart).pop()?.match(je);k?.[1]&&F?.[1]?.startsWith(k[1])&&(A.value=[...A.value.slice(0,N.value),{...i,timestamp:b},...A.value.slice(N.value+1)]);return}}A.value=[...A.value,{...i,timestamp:b}],N.value++}function be(i){R.current&&(R.current.value=i.value,Y.value=i.value,R.current.selectionStart=i.selectionStart,R.current.selectionEnd=i.selectionEnd)}function Q(i){let m=A.value[N.value];m&&R.current&&(A.value[N.value]={...m,selectionStart:R.current.selectionStart,selectionEnd:R.current.selectionEnd}),me(i),be(i)}function tr(){let i=A.value[N.value-1];i&&(be(i),N.value=Math.max(N.value-1,0))}function nr(){let i=A.value[N.value+1];i&&(be(i),N.value=Math.min(N.value+1,A.value.length-1))}let ar=i=>{let{value:m,selectionStart:b,selectionEnd:x}=i.currentTarget;Y.value=m,me({value:m,selectionStart:b,selectionEnd:x},!0)},or=i=>{if(w&&(w(i),i.defaultPrevented))return;i.key==="Escape"&&i.currentTarget.blur();let{value:m,selectionStart:b,selectionEnd:x}=i.currentTarget;if(i.key==="Tab"&&!n&&U.value)if(i.preventDefault(),i.shiftKey){let k=Z(m,b),F=k.length-1,V=Z(m,x).length-1,q=m.split(`
`).map((z,ne)=>ne>=F&&ne<=V&&z.startsWith(S)?z.substring(S.length):z).join(`
`);if(m!==q){let z=k[F];Q({value:q,selectionStart:z?.startsWith(S)?b-S.length:b,selectionEnd:x-(m.length-q.length)})}}else if(b!==x){let k=Z(m,b),F=k.length-1,V=Z(m,x).length-1,q=k[F];Q({value:m.split(`
`).map((z,ne)=>ne>=F&&ne<=V?`${S}${z}`:z).join(`
`),selectionStart:q&&/\S/.test(q)?b+S.length:b,selectionEnd:x+S.length*(V-F+1)})}else{let k=b+S.length;Q({value:`${m.substring(0,b)}${S}${m.substring(x)}`,selectionStart:k,selectionEnd:k})}else if(i.key==="Backspace"){let k=b!==x;if(m.substring(0,b).endsWith(S)&&!k){i.preventDefault();let V=b-S.length;Q({value:`${m.substring(0,b-S.length)}${m.substring(x)}`,selectionStart:V,selectionEnd:V})}}else if(i.key==="Enter"){if(b===x){let F=Z(m,b).pop()?.match(/^\s+/);if(F?.[0]){i.preventDefault();let V=`
${F[0]}`,q=b+V.length;Q({value:`${m.substring(0,b)}${V}${m.substring(x)}`,selectionStart:q,selectionEnd:q})}}}else if(i.code==="BracketLeft"||i.key==="("||i.code==="Quote"||i.code==="Backquote"){let k;i.key==="("?k=["(",")"]:i.code==="BracketLeft"?i.shiftKey?k=["{","}"]:k=["[","]"]:i.code==="Quote"?i.shiftKey?k=['"','"']:k=["'","'"]:i.code==="Backquote"&&(k=["`","`"]),b!==x&&k&&(i.preventDefault(),Q({value:`${m.substring(0,b)}${k[0]}${m.substring(b,x)}${k[1]}${m.substring(x)}`,selectionStart:b,selectionEnd:x+2}))}else(xe?i.metaKey&&i.key==="z":i.ctrlKey&&i.key==="z")&&!i.shiftKey&&!i.altKey?(i.preventDefault(),tr()):(xe?i.metaKey&&i.key==="z"&&i.shiftKey:ur?i.ctrlKey&&i.key==="y":i.ctrlKey&&i.key==="z"&&i.shiftKey)&&!i.altKey?(i.preventDefault(),nr()):i.key==="m"&&i.ctrlKey&&(!xe||i.shiftKey)&&(i.preventDefault(),U.value=!U.value)};return e("div",{...L,class:`editor font-mono ${o}`,children:[e("textarea",{ref:R,value:r,onInput:ar,onKeyDown:or,...le,class:"editArea"}),e(dr,{value:te})]})}function qe(r){return e(He,{...r,highlight:Ue})}function cr(r){if(Te(r))switch(r.kind){case"blob":return["Blob",""];case"buffer":return["buffer",""];case"file":return["File",""];default:throw new TypeError(`Unexpected meta kind: "${r.kind}"`)}else switch(r.type){case"string":case"bigint":case"ArrayBuffer":case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":case"RegExp":case"Date":case"KvU64":return[r.type,r.value];case"number":case"boolean":return[r.type,String(r.value)];case"null":return[r.type,"null"];case"undefined":return[r.type,"undefined"];case"Map":case"Set":return[r.type,JSON.stringify([...G(r)],ee,"  ")];case"Array":case"object":return[r.type,JSON.stringify(G(r),ee,"  ")];default:throw new TypeError(`Unexpected type: "${r.type}"`)}}function fe({value:r}){let[t,a]=r?cr(r):["string",void 0],n=c(t),o=c(a),d=O(()=>{switch(n.value){case"number":return e("input",{id:"value",name:"value",type:"text",pattern:"-?\\d+(\\.\\d+)?|-?Infinity|NaN",class:"block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 invalid:border-red-700",placeholder:"Provide a number",required:!0,onChange:s=>o.value=s.currentTarget.value,value:o});case"bigint":case"KvU64":return e("input",{id:"value",name:"value",type:"number",class:"block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 invalid:border-red-700",placeholder:"Provide a number",required:!0,onChange:s=>o.value=s.currentTarget.value,value:o});case"boolean":return e(C,{children:[e("input",{id:"true",name:"value",type:"radio",value:"true",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600",onChange:s=>o.value=s.currentTarget.value,checked:o.value==="true"}),e("label",{for:"true",class:"ms-2 px-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"True"}),e("input",{id:"false",name:"value",type:"radio",value:"false",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600",onChange:s=>o.value=s.currentTarget.value,checked:o.value!=="true"}),e("label",{for:"false",class:"ms-2 px-2 text-sm font-medium text-gray-900 dark:text-gray-300",children:"False"})]});case"null":return e("input",{id:"value",name:"value",type:"text",class:"block p-2.5 w-full text-sm text-gray-600 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-400 dark:focus:ring-primary-500 dark:focus:border-primary-500",value:"null",readOnly:!0});case"undefined":return e("input",{id:"value",name:"value",type:"text",class:"block p-2.5 w-full text-sm text-gray-600 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-gray-400 dark:focus:ring-primary-500 dark:focus:border-primary-500",value:"undefined",readOnly:!0});case"RegExp":return e("input",{id:"value",name:"value",type:"text",class:"block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 invalid:border-red-700",pattern:"\\/(?![*+?])([^\\r\\n\\[\\/\\\\]|\\\\.|\\[([^\\r\\n\\]\\\\]|\\\\.)*\\])+/(g(im?|mi?)?|i(gm?|mg?)?|m(gi?|ig?)?)?",placeholder:"Provide a regular expression",value:o,onChange:s=>o.value=s.currentTarget.value});case"Date":return e("input",{id:"value",name:"value",type:"text",class:"block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 invalid:border-red-700",pattern:"[0-9]{4}-((0[13578]|1[02])-(0[1-9]|[12][0-9]|3[01])|(0[469]|11)-(0[1-9]|[12][0-9]|30)|(02)-(0[1-9]|[12][0-9]))T(0[0-9]|1[0-9]|2[0-3]):(0[0-9]|[1-5][0-9]):(0[0-9]|[1-5][0-9])\\.[0-9]{3}Z",placeholder:"Provide an ISO format Date",required:!0,value:o,onChange:s=>o.value=s.currentTarget.value});case"Array":case"object":return e("div",{class:"max-h-48 overflow-auto max-w-3xl text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 invalid:border-red-700",children:e(qe,{id:"value",name:"value",placeholder:"Provide a value for the entry",required:!0,value:o})});case"buffer":case"Blob":case"File":return e("input",{id:"file",name:"file",type:"file",required:!0,class:"block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400"});default:return e("textarea",{id:"value",name:"value",rows:4,class:"block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Provide a value for the entry",value:o,required:!0,onChange:s=>o.value=s.currentTarget.value})}});return e(C,{children:[e("div",{class:"sm:col-span-2",children:[e("label",{for:"value",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Value"}),d]}),e("div",{class:"sm:col-span-2",children:[e("label",{for:"value_type",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Value Type"}),e("select",{id:"value_type",name:"value_type",value:n,onChange:s=>n.value=s.currentTarget.value,class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",children:[e("option",{value:"string",children:"String"}),e("option",{value:"number",children:"Number"}),e("option",{value:"bigint",children:"BigInt"}),e("option",{value:"boolean",children:"Boolean"}),e("option",{value:"object",children:"JSON"}),e("option",{value:"Array",children:"Array"}),e("option",{value:"Map",children:"Map"}),e("option",{value:"Set",children:"Set"}),e("option",{value:"RegExp",children:"RegExp"}),e("option",{value:"KvU64",children:"KvU64"}),e("option",{value:"Date",children:"Date"}),e("option",{value:"buffer",children:"Binary Data"}),e("option",{value:"Blob",children:"Blob"}),e("option",{value:"File",children:"File"}),e("option",{value:"ArrayBuffer",children:"ArrayBuffer"}),e("option",{value:"Int8Array",children:"Int8Array"}),e("option",{value:"Uint8Array",children:"Uint8Array"}),e("option",{value:"Uint8ClampedArray",children:"Uint8ClampedArray"}),e("option",{value:"Int16Array",children:"Int16Array"}),e("option",{value:"Uint16Array",children:"Uint16Array"}),e("option",{value:"Int32Array",children:"Int32Array"}),e("option",{value:"Uint32Array",children:"Uint32Array"}),e("option",{value:"Float32Array",children:"Float32Array"}),e("option",{value:"Float64Array",children:"Float64Array"}),e("option",{value:"BigInt64Array",children:"BigInt64Array"}),e("option",{value:"BigUint64Array",children:"BigUint64Array"}),e("option",{value:"DataView",children:"DataView"}),e("option",{value:"null",children:"Null"}),e("option",{value:"undefined",children:"Undefined"})]})]})]})}function ge({open:r,currentKey:t,databaseId:a,loadKeys:n,subEntry:o}){let d=_(null),s=c(void 0);return e(I,{class:"p-4 bg-white rounded-lg shadow dark:bg-gray-800 sm:p-5",open:r,children:[e("div",{class:"flex justify-between items-center pb-4 mb-4 rounded-t border-b sm:mb-5 dark:border-gray-600",children:[e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white",children:o?"Add sub-entry":"Add entry"}),e(M,{onClick:()=>{s.value=void 0,d.current?.reset(),r.value=!1}})]}),e(W,{children:s}),e("form",{method:"dialog",ref:d,onSubmit:g=>{s.value;let{currentTarget:u}=g,l=new FormData(u),p=l.get("key_part_type"),f=l.get("key_part"),y=l.get("value_type"),v=l.get("value"),h=l.get("file"),K=l.get("expires_in"),B=l.get("overwrite");T(typeof p=="string"&&typeof f=="string"&&typeof y=="string"&&(v===null||typeof v=="string")&&(h===null||h instanceof File)&&typeof K=="string");let D=[...t.value??[],ie(p,f)],H=`/api/kv/${a}/${J(D)}`;ye(y,v,h).then(w=>{let L=JSON.stringify({value:w,expiresIn:K?parseInt(K,10):void 0,overwrite:B==="true"});return fetch(new URL(H,import.meta.url),{body:L,method:"PUT",headers:{"content-type":"application/json"}})}).then(w=>{if(w.ok)E("Entry added successfully.","success",!0),u.reset(),n(),r.value=!1;else if(w.status===409)s.value="Key already exists, overwrite not specified.";else return s.value="Error adding entry.",w.json().then(L=>console.error(L))}).catch(w=>{s.value="Error adding entry.",console.error(w)}),g.preventDefault()},children:[e("div",{class:"grid gap-4 mb-4 sm:grid-cols-2",children:[e("div",{class:"sm:col-span-2",children:[e("h2",{class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Parent Key"}),e(P,{value:t,showRoot:!0,noLink:!0})]}),e(Re,{}),e(fe,{}),e("div",{children:[e(re,{for:"expires_in",children:"Expires In"}),e("input",{type:"number",id:"expires_in",name:"expires_in",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"in milliseconds (optional)"})]}),e("fieldset",{children:[e("legend",{class:"block mb-2 test-sm font-medium text-gray-900 dark:text-white",children:"Consistency"}),e("div",{class:"flex",children:[e("div",{class:"flex items-center h-5",children:e("input",{id:"overwrite",name:"overwrite","aria-describedby":"overwrite-text",type:"checkbox",value:"true",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"})}),e("div",{class:"ml-2 text-sm",children:[e(re,{for:"overwrite",children:"Overwrite if exists"}),e("p",{id:"overwrite-text",class:"text-xs font-normal text-gray-500 dark:text-gray-300 max-w-xs",children:"If the key already exists, replace the value with the supplied value. Otherwise, if the key already exists, attempting to add the entry will fail."})]})]})]})]}),e(de,{children:o?"Add new sub-entry":"Add new entry"})]})]})}function ze({open:r,databaseId:t,prefix:a,loadKeys:n}){let o=_(null),d=c(void 0),s=c(!1),g=c(!1),u=O(()=>!X.selectedCount.value||g.value);function l(){s.value=!0;let p=`/api/kv/${t}/${J(a?.value??[])}?tree`;fetch(new URL(p,import.meta.url)).then(f=>f.ok?f.json().then(y=>{X.tree.value=Be(y)}):(console.error(`Unable to fetch tree: ${f.status} ${f.statusText}`),f.text().then(y=>console.error(`Response body:

${y}`)))).finally(()=>{s.value=!1})}return ae(l),t?e(I,{class:"p-4 bg-white rounded-lg shadow dark:bg-gray-800 sm:p-5 md:w-1/2 xl:w-1/3",open:r,children:[e("div",{class:"flex justify-between items-center pb-4 mb-4 rounded-t border-b sm:mb-5 dark:border-gray-600",children:[e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white",children:"Delete Entries"}),e(M,{onClick:()=>{d.value=void 0,r.value=!1,De(X.tree)}})]}),e(W,{children:d}),e("form",{method:"dialog",ref:o,onSubmit:p=>{d.value=void 0,g.value=!0;let f=`/api/kv/${t}${a?.value?.length?`/${J(a.value)}`:""}`,y=JSON.stringify(X.selected.value);fetch(new URL(f,import.meta.url),{body:y,method:"DELETE",headers:{"content-type":"application/json"}}).then(v=>{if(v.ok)E("Successfully deleted entries.","success",!0),r.value=!1,l(),n();else return d.value="Error deleting entries.",v.json().then(h=>console.error(h))}).catch(v=>{d.value="Error deleting entries.",console.log(v)}).finally(()=>{g.value=!1}),p.preventDefault()},children:[e("p",{class:"mb-4 font-light text-gray-500 dark:text-gray-400",children:"Select keys of entries to be deleted. Selecting a parent key part will also select the children. The arrows can be used to expand or collapse children."}),e("div",{class:"h-48 md:h-64 lg:h-72 xl:h-96 rounded p-2 bg-gray-50 dark:bg-gray-900 overflow-auto mb-6",children:e(Ne.Provider,{value:X,children:s.value?e("div",{class:"bg-gray-100 dark:bg-gray-800 flex items-center justify-center",children:e(oe,{})}):e(Je,{})})}),e("button",{class:"flex items-center justify-center font-bold text-white bg-red-700 disabled:bg-gray-700 hover:bg-red-800 focus:ring-4 focus:ring-red-300 rounded-lg text-sm px-4 py-2 dark:bg-red-600 dark:disabled:bg-gray-600 dark:hover:bg-red-700 focus:outline-none dark:focus:ring-red-800",type:"submit",disabled:u,children:["Delete ",X.selectedCount," ",X.selectedCount.value===1?"entry":"entires"]})]})]}):null}function Xe({open:r,databaseId:t,prefix:a}){let n=O(()=>`/api/kv/${t}/_bulk/${J(a.value)}`);return t?e(I,{class:"p-4 bg-white rounded-lg shadow dark:bg-gray-800 sm:p-5",open:r,children:[e("div",{class:"flex justify-between items-center pb-4 mb-4 rounded-t border-b sm:mb-5 dark:border-gray-600",children:[e("h3",{class:"mb-1 text-lg font-semibold text-gray-900 dark:text-white",children:"Confirm Export"}),e(M,{onClick:()=>r.value=!1})]}),a.value.length?e(C,{children:[e("p",{class:"mb-4 font-light text-gray-500 dark:text-gray-400",children:"This will download entries as new line delimitated JSON with a prefix of:"}),e("div",{class:"border rounded p-2 dark:bg-gray-900 m-2",children:e(P,{value:a,noLink:!0})})]}):e("p",{class:"mb-4 font-light text-gray-500 dark:text-gray-400",children:"This will download all the entries as new line delimitated JSON."}),e("p",{class:"my-4 font-light text-gray-500 dark:text-gray-400",children:"See the documentation for further details."}),e("div",{class:"flex items-center space-x-4",children:[e("button",{"data-modal-toggle":"deleteListModal",type:"button",class:"py-2 px-3 text-sm font-medium text-gray-500 bg-white rounded-lg border border-gray-200 hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-primary-300 hover:text-gray-900 focus:z-10 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600",onClick:()=>r.value=!1,children:"Cancel"}),e("a",{href:n,class:"flex items-center justify-center font-bold text-white bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 rounded-lg text-sm px-4 py-2 dark:bg-primary-600 dark:hover:bg-primary-700 focus:outline-none dark:focus:ring-primary-800",onClick:()=>r.value=!1,children:"Download"})]})]}):null}function We({open:r,databaseId:t,prefix:a,name:n,href:o}){let d=O(()=>a.value.length?`/api/kv/${t}/_bulk/${J(a.value)}`:`/api/kv/${t}/_bulk`),s=_(null),g=c(void 0),u=c(!1);return t?e(I,{class:"p-4 bg-white rounded-lg shadow dark:bg-gray-800 sm:p-5",open:r,children:[e("div",{class:"flex justify-between items-center pb-4 mb-4 rounded-t border-b sm:mb-5 dark:border-gray-600",children:[e("h3",{class:"mb-1 text-lg font-semibold text-gray-900 dark:text-white",children:"Import Entries"}),e(M,{onClick:()=>{s.current?.reset(),r.value=!1}})]}),e(W,{children:g}),e("form",{method:"dialog",ref:s,onSubmit:l=>{u.value=!1;let{currentTarget:p}=l,f=new FormData(p),y=f.get("data"),v=f.get("format"),h=f.has("overwrite");if(v&&y&&y instanceof File){T(typeof v=="string");let K={"content-type":v};n&&(K["kview-name"]=n),o&&(K["kview-href"]=o),h&&(K["kview-overwrite"]="true"),fetch(new URL(d.value,import.meta.url),{method:"POST",body:y,headers:K}).then(B=>{if(u.value=!1,B.ok)B.json().then(({id:D})=>{E(`Job #${D} created.`,"success",!0),p.reset(),r.value=!1});else return g.value="Error creating import job.",B.json().then(D=>console.error(D))}).catch(B=>{u.value=!1,g.value="Error creating import job.",console.error(B)})}l.preventDefault()},children:[e("label",{for:"data",class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"File"}),e("input",{type:"file",name:"data",id:"data",accept:".ndjson,.jsonl,application/x-ndjson,application/jsonl,application/json-lines",class:"block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50 dark:text-gray-400 focus:outline-none dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400"}),e("label",{for:"format",class:"mt-4 block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"File format"}),e("select",{name:"format",id:"format",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",children:e("option",{value:"application/x-ndjson",children:"New Line Delimitated JSON (.ndjson)"})}),e("div",{class:"flex my-4",children:[e("div",{class:"flex items-center h-5",children:e("input",{id:"overwrite",name:"overwrite","aria-describedby":"overwrite-text",type:"checkbox",value:"true",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"})}),e("div",{class:"ml-2 text-sm",children:[e("label",{for:"overwrite",class:"font-medium text-gray-900 dark:text-gray-300",children:"Overwrite if exists"}),e("p",{id:"overwrite-text",class:"text-xs font-normal text-gray-500 dark:text-gray-300 max-w-xs",children:"By default, any imported entries which have a key that matches a key of an existing entry will be skipped. By selecting to overwrite, the import process will not check if keys exist."})]})]}),e("div",{class:"flex items-center space-x-4",children:e("button",{class:"flex items-center justify-center font-bold text-white bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 rounded-lg text-sm px-4 py-2 dark:bg-primary-600 dark:hover:bg-primary-700 focus:outline-none dark:focus:ring-primary-800",type:"submit",disabled:u,children:"Import entries..."})})]})]}):null}var pr=[["string","String"],["number","Number"],["bigint","BigInt"],["boolean","Boolean"],["undefined","Undefined"],["null","Null"],["Array","Array"],["Map","Map"],["Set","Set"],["object","JSON"],["RegExp","RegExp"],["Date","Date"],["KvU64","KvU64"],["ArrayBuffer","ArrayBuffer"],["DataView","DataView"],["Int8Array","Int8Array"],["Uint8Array","Uint8Array"],["Uint8ClampedArray","Uint8ClampedArray"],["Int16Array","Int16Array"],["Uint16Array","Uint16Array"],["Int32Array","Int32Array"],["Uint32Array","Uint32Array"],["Float32Array","Float32Array"],["Float64Array","Float64Array"],["BigInt64Array","BigInt64Array"],["BigUint64Array","BigUint64Array"]];function yr({id:r,type:t,value:a,onChange:n}){switch(t){case"number":return e("input",{id:`value-${r}`,name:`value-${r}`,type:"text",class:"bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 invalid:border-red-700",pattern:"-?\\d+(\\.\\d+)?|-?Infinity|NaN",placeholder:"Number",required:!0,onChange:n,value:a});case"bigint":case"KvU64":return e("input",{id:`value-${r}`,name:`value-${r}`,type:"number",class:"bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 invalid:border-red-700",placeholder:"Number",required:!0,onChange:n,value:a});case"boolean":return e("select",{id:`value-${r}`,name:`value-${r}`,class:"bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",onChange:n,value:a,children:[e("option",{children:"true"}),e("option",{children:"false"})]});case"null":case"undefined":return e("input",{id:`value-${r}`,name:`value-${r}`,type:"text",class:"bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",value:t==="null"?"null":"undefined",readOnly:!0});case"RegExp":return e("input",{id:`value-${r}`,name:`value-${r}`,type:"text",class:"bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 invalid:border-red-700",pattern:"\\/(?![*+?])([^\\r\\n\\[\\/\\\\]|\\\\.|\\[([^\\r\\n\\]\\\\]|\\\\.)*\\])+/(g(im?|mi?)?|i(gm?|mg?)?|m(gi?|ig?)?)?",placeholder:"RegExp",required:!0,onChange:n,value:a});case"Date":return e("input",{id:`value-${r}`,name:`value-${r}`,type:"text",class:"bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 invalid:border-red-700",pattern:"[0-9]{4}-((0[13578]|1[02])-(0[1-9]|[12][0-9]|3[01])|(0[469]|11)-(0[1-9]|[12][0-9]|30)|(02)-(0[1-9]|[12][0-9]))T(0[0-9]|1[0-9]|2[0-3]):(0[0-9]|[1-5][0-9]):(0[0-9]|[1-5][0-9])\\.[0-9]{3}Z",placeholder:"Date",required:!0,onChange:n,value:a});case"ArrayBuffer":case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":return e("input",{id:`value-${r}`,name:`value-${r}`,type:"text",class:"bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500 invalid:border-red-700",pattern:"[-A-Za-z0-9+/]*={0,3}",placeholder:"Base64",required:!0,onChange:n,value:a});default:return e("input",{id:`value-${r}`,name:`value-${r}`,type:"text",class:"bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",placeholder:"Value",required:!0,onChange:n,value:a})}}function Ye({type:r,id:t,value:a,only:n,onChange:o}){let d=s=>{o(r,s.currentTarget.value)};return e(C,{children:[e("select",{id:`value_type-${t}`,name:`value_type-${t}`,value:r,class:"bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",onChange:s=>o(s.currentTarget.value,a),children:pr.filter(([s])=>n?n.includes(s):!0).map(([s,g],u)=>e("option",{value:s,children:g},u))}),e(yr,{id:t,type:r,value:a,onChange:d})]})}function se({size:r=6}){return e("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",class:`w-${r} h-${r}`,fill:"currentColor",children:e("use",{href:`${$("/sprites.svg")}#plus`})})}var fr=["bigint","boolean","number","string","undefined","null","object","Array","Map","Set","RegExp","Date","KvU64","ArrayBuffer","DataView","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array","Error","EvalError","RangeError","ReferenceError","SyntaxError","TypeError","URIError"];function gr(r,t){switch(r){case"string":case"number":case"bigint":case"boolean":case"Uint8Array":return ie(r,t);case"null":return{type:r,value:null};case"undefined":return{type:r};case"Map":{let a=JSON.parse(t);return j(new Map(Array.isArray(a)?a:[]))}case"Set":{let a=JSON.parse(t);return j(new Set(Array.isArray(a)?a:[]))}case"Array":{let a=JSON.parse(t);return{type:r,value:Array.isArray(a)?a.map(j):[]}}case"object":{let a=JSON.parse(t),n={};return typeof a=="object"&&a!==null&&(n=Object.fromEntries(Object.entries(a).map(([o,d])=>[o,j(d)]))),{type:r,value:n}}case"RegExp":case"Date":case"KvU64":return{type:r,value:t};case"ArrayBuffer":case"Int8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":case"DataView":return{type:r,value:t,byteLength:pe(t)};default:throw new TypeError(`Unexpected type: "${r}"`)}}function mr(r){if(!r)return["string",""];switch(r.type){case"string":case"bigint":case"ArrayBuffer":case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":case"RegExp":case"Date":case"KvU64":return[r.type,r.value];case"number":case"boolean":return[r.type,String(r.value)];case"null":return[r.type,"null"];case"undefined":return[r.type,"undefined"];case"Map":case"Set":return[r.type,JSON.stringify([...G(r)],ee)];case"Array":case"object":return[r.type,JSON.stringify(G(r),ee)];default:return["string",""]}}function br({index:r,filter:t,onChange:a}){let n=c(t.filters.length?t.filters:[{kind:""}]),o=(u,l)=>{n.value=n.value.map((p,f)=>f===u?l:p),a(r,{kind:t.kind,filters:[...n.peek()]})},d=u=>{n.value=n.value.filter((l,p)=>p!==u),a(r,{kind:t.kind,filters:[...n.peek()]})},s=()=>{n.value=[...n.value,{kind:""}],a(r,{kind:t.kind,filters:[...n.peek()]})},g=n.value.map((u,l)=>e(we,{index:l,id:`${r}-${l}`,filter:u,onChange:o,onRemove:d},`${r}-${l}`));return e("div",{class:"pl-2 border-l dark:border-gray-600 space-y-3",children:[g,e("a",{href:"#",class:"flex items-center pb-2 text-sm font-medium text-primary-600 dark:text-primary-500 hover:underline",onClick:s,children:[e(se,{}),"Add Condition"]})]})}function we({filter:r,index:t,id:a,onChange:n,onRemove:o}){let d=u=>{switch(u.target.value){case"where":n(t,{kind:"where",property:"",operation:"==",value:{type:"string",value:""}});break;case"value":n(t,{kind:"value",operation:"==",value:{type:"string",value:""}});break;case"and":n(t,{kind:"and",filters:[]});break;case"or":n(t,{kind:"or",filters:[]});break}},s=u=>{if(r.kind==="where"||r.kind==="value"){let l=u.target.value,p=r.value;l==="in"||l==="not-in"||l==="array-contains-any"?p={type:"Array",value:[]}:l==="matches"?p={type:"RegExp",value:""}:l==="kind-of"&&(p={type:"string",value:""}),n(t,{...r,operation:l,value:p})}},g=e("div",{class:"block",children:"\xA0"});if(r.kind==="where"||r.kind==="value"){let u;r.operation==="in"||r.operation==="not-in"||r.operation==="array-contains-any"?u=["Array"]:r.operation==="matches"&&(u=["RegExp"]);let[l,p]=mr(r.value),f=(y,v)=>{try{let h=gr(y,v);n(t,{...r,value:h})}catch(h){console.error(h)}};g=r.operation!=="kind-of"?e(Ye,{id:a,type:l,value:p,only:u,onChange:f}):e("select",{id:`value_type-${a}`,name:`value_type-${a}`,class:"bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",onChange:y=>{let v=y.currentTarget.value;n(t,{...r,value:{type:"string",value:v}})},children:[e("option",{value:"",selected:!r.value.value,disabled:!0,children:"Kind"}),fr.map(y=>(T(r.value.type==="string"),e("option",{selected:r.value.value===y,children:y})))]})}return e(C,{children:[e("div",{class:"flex items-center space-x-3 rounded-lg",children:[e("div",{class:"grid w-full grid-cols-2 gap-2 md:gap-3 md:grid-cols-5",children:[e("select",{id:`kind-${a}`,class:"bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",onChange:d,children:[e("option",{value:"",selected:r.kind==="",disabled:!0,children:"Kind"}),e("option",{selected:r.kind==="where",children:"where"}),e("option",{selected:r.kind==="value",children:"value"}),e("option",{selected:r.kind==="and",children:"and"}),e("option",{selected:r.kind==="or",children:"or"})]}),r.kind==="where"?e("input",{type:"text",id:`property-${a}`,placeholder:"Property",required:!0,class:"bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",value:Array.isArray(r.property)?r.property.join("."):r.property,onChange:u=>{let l=u.currentTarget.value;n(t,{...r,property:l.includes(".")?l.split("."):l})}}):e("div",{class:"block w-full",children:"\xA0"}),r.kind==="where"||r.kind==="value"?e("select",{id:`operator-${a}`,class:"bg-white border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500",onChange:s,children:[e("option",{value:"",selected:!r.operation,disabled:!0,children:"Operator"}),e("option",{value:"<",selected:r.operation==="<",children:"<"}),e("option",{value:"<=",selected:r.operation==="<=",children:"<="}),e("option",{value:"==",selected:r.operation==="==",children:"=="}),e("option",{value:"!=",selected:r.operation==="!=",children:"!="}),e("option",{value:">=",selected:r.operation===">=",children:">="}),e("option",{value:">",selected:r.operation===">",children:">"}),e("option",{value:"array-contains",selected:r.operation==="array-contains",children:"contains"}),e("option",{value:"array-contains-any",selected:r.operation==="array-contains-any",children:"contains any"}),e("option",{value:"in",selected:r.operation==="in",children:"in"}),e("option",{value:"not-in",selected:r.operation==="not-in",children:"not in"}),e("option",{value:"matches",selected:r.operation==="matches",children:"matches"}),e("option",{value:"kind-of",selected:r.operation==="kind-of",children:"kind of"})]}):e("div",{class:"block min-w-56",children:"\xA0"}),g]}),e("button",{type:"button",class:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",onClick:()=>o(t),children:[e($e,{}),e("span",{class:"sr-only",children:"Delete"})]})]}),r.kind==="and"||r.kind==="or"?e(br,{index:t,filter:r,onChange:n}):void 0]})}function Ze({open:r,filters:t,active:a}){let n=_(null),o=c(t.peek().length?[...t.value]:[{kind:""}]),d=(l,p)=>o.value=o.value.map((f,y)=>y===l?p:f),s=l=>o.value=o.value.filter((p,f)=>f!==l),g=()=>{o.value=[...o.value,{kind:""}]},u=O(()=>o.value.map((l,p)=>e(we,{index:p,id:String(p),filter:l,onChange:d,onRemove:s},p)));return e(I,{class:"p-4 bg-white rounded-lg shadow dark:bg-gray-800 sm:p-5",open:r,children:[e("div",{class:"flex justify-between items-center pb-4 mb-4 rounded-t border-b sm:mb-5 dark:border-gray-600",children:[e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white",children:"Filter"}),e(M,{onClick:()=>{n.current?.reset(),o.value=t.value.length?[...t.value]:[{kind:""}],r.value=!1}})]}),e("form",{method:"dialog",ref:n,class:"z-10 w-full max-w-screen-md space-y-3",onSubmit:l=>{t.value=o.value.filter(p=>p.kind!==""),t.value.length>0&&(a.value=!0,E("Filter applied","success",!0,5)),r.value=!1},children:[u,e("a",{href:"#",class:"flex items-center pb-2 text-sm font-medium border-b dark:border-gray-600 text-primary-600 dark:text-primary-500 hover:underline",onClick:g,children:[e(se,{}),"Add Condition"]}),e("div",{class:"flex items-center justify-between",children:[e("button",{type:"submit",class:"text-white bg-primary-600 hover:bg-primary-800 focus:ring-4 focus:outline-none focus:ring-primary-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:focus:ring-primary-800",children:"Apply"}),e("button",{type:"reset",class:"py-2.5 px-5 flex items-center hover:bg-gray-100 dark:hover:bg-gray-600 text-sm font-medium text-gray-900 focus:outline-none rounded-lg hover:text-black focus:z-10 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 dark:text-gray-400 dark:hover:text-white",onClick:()=>{n.current?.reset(),o.value=[{kind:""}],a.value=!1},children:[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-4 h-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:e("path",{"fill-rule":"evenodd","clip-rule":"evenodd","aria-hidden":"true",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"})}),"Clear all"]})]})]})]})}function Ke({size:r=6}){return e("svg",{class:`w-${r} h-${r}`,version:"1.1",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",children:e("use",{href:`${$("/sprites.svg")}#expand`})})}function Se({size:r=6}){return e("svg",{class:`w-${r} h-${r}`,version:"1.1",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",children:e("use",{href:`${$("/sprites.svg")}#right_arrow`})})}function vr({item:{key:r,count:t,isBlob:a},currentEntryKey:n,currentKey:o}){function d(s){s.preventDefault(),t?(n.value={key:r,isBlob:a},o.value=[...r]):n.value={key:r,isBlob:a}}return e("li",{class:"py-2 dark:hover:bg-gray-700 hover:bg-gray-200 group",children:e("a",{href:"#",onClick:d,class:"flex items-center",children:[e("div",{class:"flex-grow",children:e(Ce,{part:r[r.length-1]})}),e("div",{class:"flex-none mx-2 text-gray-500 dark:text-gray-400 group-hover:text-gray-900 group-hover:dark:text-white",children:t?e(Ke,{size:4}):e(Se,{size:4})})]})})}function Qe({list:r,currentEntryKey:t,currentKey:a}){return r.value.length?e("ul",{class:"divide-y bg-gray-100 dark:bg-gray-800 rounded divide-gray-200 dark:divide-gray-700 h-48 md:h-64 lg:h-72 xl:h-96 overflow-y-auto",children:r.value.map(n=>e(vr,{currentEntryKey:t,currentKey:a,item:n}))}):e("div",{class:"h-48 md:h-64 lg:h-72 xl:h-96"})}function Ge({open:r,entry:t,databaseId:a,loadValue:n,loadKeys:o}){return t.value?e(I,{class:"p-4 bg-white rounded-lg shadow dark:bg-gray-800 sm:p-5",open:r,children:[e("button",{type:"button",class:"text-gray-400 absolute top-2.5 right-2.5 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white",onClick:()=>r.value=!1,children:[e("svg",{"aria-hidden":"true",class:"w-5 h-5",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:e("use",{href:`${$("/sprites.svg")}#close`})}),e("span",{class:"sr-only",children:"Close modal"})]}),e("h3",{class:"mb-1 text-lg font-semibold text-gray-900 dark:text-white",children:"Are you sure?"}),e("p",{class:"mb-4 font-light text-gray-500 dark:text-gray-400",children:"You are about to delete the entry with a key of:"}),e("div",{class:"mb-4",children:e(P,{value:t.value.key,noLink:!0})}),e("div",{class:"flex items-center space-x-4",children:[e("button",{"data-modal-toggle":"deleteListModal",type:"button",class:"py-2 px-3 text-sm font-medium text-gray-500 bg-white rounded-lg border border-gray-200 hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-primary-300 hover:text-gray-900 focus:z-10 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600",onClick:()=>r.value=!1,children:"No, cancel"}),e("button",{type:"submit",class:"inline-flex items-center py-2 px-3 text-sm font-medium text-center text-white bg-red-600 rounded-lg hover:bg-red-700 focus:ring-4 focus:outline-none focus:ring-red-300 dark:bg-red-500 dark:hover:bg-red-600 dark:focus:ring-red-900",onClick:()=>{T(t.value);let d=`/api/kv/${a}/${J(t.value.key)}${"meta"in t.value?"?blob":""}`,s=JSON.stringify({versionstamp:t.value.versionstamp});r.value=!1,fetch(new URL(d,import.meta.url),{body:s,method:"DELETE",headers:{"content-type":"application/json"}}).then(g=>{if(g.ok)E("Entry successfully deleted.","success",!0),o();else if(g.status===409)E("Entry has changed. Delete failed.","error");else return E("Error deleting entry.","error"),g.json().then(u=>console.error(u));n()}).catch(g=>{E("Error deleting value.","error"),console.error(g)})},children:[e("svg",{"aria-hidden":"true",class:"w-4 h-4 mr-1.5 -ml-1",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:e("use",{href:`${$("/sprites.svg")}#trash_sm`})}),"Yes, delete"]})]})]}):null}function er({open:r,entry:t,databaseId:a,loadValue:n}){let o=_(null),d=c(void 0),s=O(()=>t.value.value??t.value.meta),g=O(()=>t.value.versionstamp),u=O(()=>!!(t.value.value||t.value.meta)),l=O(()=>t.value.key);return t.value?e(I,{class:"p-4 bg-white rounded-lg shadow dark:bg-gray-800 sm:p-5",open:r,children:[e("div",{class:"flex justify-between items-center pb-4 mb-4 rounded-t border-b sm:mb-5 dark:border-gray-600",children:[e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white",children:u?"Edit value":"Add value"}),e(M,{onClick:()=>{d.value=void 0,o.current?.reset(),r.value=!1}})]}),e(W,{children:d}),e("form",{method:"dialog",ref:o,onSubmit:p=>{d.value==null;let{currentTarget:f}=p,y=new FormData(f),v=y.get("value_type"),h=y.get("value"),K=y.get("file"),B=y.get("expires_in"),D=y.get("overwrite");T(typeof v=="string"&&(!h||typeof h=="string")&&(K===null||K instanceof File)&&typeof B=="string"&&u);let H=`/api/kv/${a}/${J(l.value)}`;ye(v,h,K).then(w=>{let L=JSON.stringify({value:w,expiresIn:B?parseInt(B,10):void 0,overwrite:D==="true",versionstamp:g.value});return fetch(new URL(H,import.meta.url),{body:L,method:"PUT",headers:{"content-type":"application/json"}})}).then(w=>{if(w.ok)E(u?"Value successfully updated.":"Value successfully set.","success",!0),f.reset(),n(),r.value=!1;else if(w.status===409)d.value='Value in the store has changed. To ignore an update anyway, select "overwrite" option.';else return d.value="Error setting value.",w.json().then(L=>console.error(L))}).catch(w=>{d.value="Error setting value.",console.error(w)}),p.preventDefault()},children:[e("div",{class:"grid gap-4 mb-4 sm:grid-cols-2",children:[e("div",{class:"sm:col-span-2",children:[e("h2",{class:"block mb-2 text-sm font-medium text-gray-900 dark:text-white",children:"Key"}),e(P,{value:l,noLink:!0})]}),e(fe,{value:s.value}),e("div",{children:[e("label",{for:"expires_in",class:"block mb-2 test-sm font-medium text-gray-900 dark:text-white",children:"Expires In"}),e("input",{type:"number",id:"expires_in",name:"expires_in",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"in milliseconds (optional)"})]}),u&&e("fieldset",{children:[e("legend",{class:"block mb-2 test-sm font-medium text-gray-900 dark:text-white",children:"Consistency"}),e("div",{class:"flex",children:[e("div",{class:"flex items-center h-5",children:e("input",{id:"overwrite",name:"overwrite","aria-describedby":"overwrite-text",type:"checkbox",value:"true",class:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600"})}),e("div",{class:"ml-2 text-sm",children:[e("label",{for:"overwrite",class:"font-medium text-gray-900 dark:text-gray-300",children:"Overwrite if different"}),e("p",{id:"overwrite-text",class:"text-xs font-normal text-gray-500 dark:text-gray-300 max-w-xs",children:"By default, the version of the value will be checked against what is currently stored, and the update will fail if it is different. Checking this value will skip this validation."})]})]})]})]}),e("button",{class:"flex items-center justify-center font-bold text-white bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 rounded-lg text-sm px-4 py-2 dark:bg-primary-600 dark:hover:bg-primary-700 focus:outline-none dark:focus:ring-primary-800",type:"submit",children:u?"Update value":"Add value"})]})]}):null}function Ae({size:r=6}){return e("svg",{class:`w-${r} h-${r}`,version:"1.1",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",children:e("use",{href:`${$("/sprites.svg")}#observe`})})}async function hr(r,t,a,n){let o=await fetch(new URL("/api/watch",import.meta.url),{method:"PUT",body:JSON.stringify({databaseId:r,key:t,name:a,href:n}),headers:{"content-type":"application/json"}});o.ok?E("Watch added.","success",!0):(E("Error adding watch.","error",!0),console.error(`Status: ${o.status} ${o.statusText}

${await o.text()}`))}function rr({entry:r,loadValue:t,loadKeys:a,databaseId:n,name:o,href:d}){let s=c(!1),g=c(!1),u=c(!1),l=O(()=>r.value?.key);if(!r.value)return null;let{versionstamp:p,value:f,meta:y,key:v}=r.value,h=Le(f??y);return e(C,{children:[h&&e(er,{open:s,entry:r,databaseId:n,loadValue:t}),e(ge,{open:g,currentKey:l,databaseId:n,loadKeys:a,subEntry:!0}),e(Ge,{open:u,entry:r,databaseId:n,loadValue:t,loadKeys:a}),e("div",{class:"border rounded p-2 lg:col-span-2",children:[e("div",{class:"flex",children:[e("h2",{class:"font-bold my-2 flex-grow",children:"Key"}),n&&!("meta"in r.value)?e("button",{type:"button",class:"flex-none text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:ring-4 focus:outline-none focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-1.5",onClick:()=>hr(n,v,o,d),children:e(Ae,{size:4})}):void 0]}),e(P,{value:l}),f||y?e(C,{children:[e(Fe,{databaseId:n,currentKey:v,value:f,meta:y}),p&&e("div",{class:"text-sm text-gray-600 dark:text-gray-400 p-1 italic",children:["Version: ",p]})]}):e("div",{class:"w-auto p-8 flex justify-center",children:e("div",{class:"italic text-gray-600 dark:text-gray-400",children:"no value"})}),e("div",{class:"w-full my-2 md:w-auto flex flex-col md:flex-row space-y-2 md:space-y-0 items-stretch md:items-center justify-end md:space-x-3 flex-shrink-0",children:[(!(f||y)||h)&&e("button",{class:"flex items-center justify-center font-bold text-white bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 rounded-lg text-sm px-4 py-2 dark:bg-primary-600 dark:hover:bg-primary-700 focus:outline-none dark:focus:ring-primary-800",type:"button",onClick:()=>s.value=!0,children:f||y?"Update value...":"Add value..."}),e("button",{class:"flex items-center justify-center font-bold text-white bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 rounded-lg text-sm px-4 py-2 dark:bg-primary-600 dark:hover:bg-primary-700 focus:outline-none dark:focus:ring-primary-800",type:"button",onClick:()=>g.value=!0,children:"Add sub-entry..."}),f||y?e("button",{class:"flex items-center justify-center font-bold text-white bg-primary-700 hover:bg-red-800 focus:ring-4 focus:ring-red-300 rounded-lg text-sm px-4 py-2 dark:bg-red-600 dark:hover:bg-red-700 focus:outline-none dark:focus:ring-red-800",type:"button",onClick:()=>u.value=!0,children:"Delete entry"}):void 0]})]})]})}function Oe({size:r=6}){return e("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",class:`w-${r} h-${r}`,fill:"currentColor",children:e("use",{href:`${$("/sprites.svg")}#filter`})})}function kr({db:r,id:t,label:a,href:n}){let o=c([]),d=c(!1),s=c(!1),g=c([]),u=c(!1),l=c(!1),p=c(!1),f=c(!1),y=c(!1),v=c([]),h,K=r?.databaseId??t;function B(){let Y=`/api/kv/${K}/${J(o.value)}`;d.value=!0,h&&h.abort(),h=new AbortController;let{signal:te}=h,U=new URL(Y,import.meta.url);u.value&&U.searchParams.set("q",ue(JSON.stringify(g.value))),fetch(U,{signal:te}).then(S=>S.ok?S.json().then(A=>v.value=A):(console.error(`Unable to fetch keys: ${S.status} ${S.statusText}`),S.text().then(A=>console.error(`Response body:

${A}`)))).finally(()=>{d.value=!1,h=void 0})}ae(B);let D=c(null),H=c(!1),w=c(null),L;function le(){if(w.value=null,D.value===null)return;let Y=`/api/kv/${K}/${J(D.value.key)}?${D.value.isBlob?"meta":"entry"}`;H.value=!0,L&&L.abort(),L=new AbortController;let{signal:te}=L;fetch(new URL(Y,import.meta.url),{signal:te}).then(U=>{if(U.status===200)return U.json().then(S=>w.value=S);if(U.status===404){D.value&&(w.value={key:[...D.value.key]});return}return console.error(`Unable to fetch entry: ${U.status} ${U.statusText}`),U.text().then(S=>console.error(`Response body:

${S}`))}).finally(()=>{H.value=!1,h=void 0})}return ae(le),e(C,{children:[e(_e,{}),e(ge,{open:s,currentKey:o,loadKeys:B,databaseId:K}),e(Xe,{open:l,databaseId:K,prefix:o}),e(We,{open:p,databaseId:K,prefix:o,name:a,href:n}),e(ze,{open:y,databaseId:K,prefix:o,loadKeys:B}),e(Ze,{open:f,filters:g,active:u}),e("div",{class:"border rounded p-2",children:[e("h2",{class:"font-bold mb-2",children:"Path"}),e(P,{value:o,entry:D,showRoot:!0}),e("div",{class:"flex items-center",children:[e("h2",{class:"font-bold my-2",children:"Keys"}),e("button",{type:"button",class:u.value?"text-primary-700 dark:text-primary-500 bg-transparent hover:bg-gray-200 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-600":"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-600 dark:hover:text-white",onClick:()=>{u.value?(u.value=!1,E("Filter removed","success",!0,5)):f.value=!0},children:[e(Oe,{size:5}),e("span",{class:"sr-only",children:"Filter"})]})]}),d.value?e("div",{class:"h-48 md:h-64 lg:h-72 xl:h-96 bg-gray-100 dark:bg-gray-800 rounded flex items-center justify-center",children:e(oe,{})}):e(Qe,{list:v,currentKey:o,currentEntryKey:D}),e("div",{class:"w-full my-2 md:w-auto flex flex-col md:flex-wrap md:flex-row space-y-2 md:space-y-0 items-stretch md:items-center justify-end md:space-x-3 flex-shrink-0",children:[e("button",{type:"button",class:"flex items-center justify-center font-bold text-white bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 rounded-lg text-sm px-4 py-2 dark:bg-primary-600 dark:hover:bg-primary-700 focus:outline-none dark:focus:ring-primary-800 md:m-1",onClick:()=>p.value=!0,children:"Import..."}),e("button",{type:"button",class:"flex items-center justify-center font-bold text-white bg-primary-700 hover:bg-primary-800 focus:ring-4 focus:ring-primary-300 rounded-lg text-sm px-4 py-2 dark:bg-primary-600 dark:hover:bg-primary-700 focus:outline-none dark:focus:ring-primary-800 md:m-2",onClick:()=>l.value=!0,children:"Export..."}),e("button",{type:"button",class:"flex items-center justify-center font-bold text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:ring-red-300 rounded-lg text-sm px-4 py-2 dark:bg-red-600 dark:hover:bg-red-700 focus:outline-none dark:focus:ring-red-800 md:m-2",onClick:()=>y.value=!0,children:"Delete..."}),e(de,{class:"md:m-2",onClick:()=>s.value=!0,children:"Add entry..."})]})]}),H.value?e("div",{class:"border rounded p-2 col-span-2 flex items-center justify-center",children:e(oe,{})}):e(rr,{entry:w,databaseId:K,name:a,href:n,loadKeys:B,loadValue:le})]})}export{kr as default};
