import{a as k}from"./chunk-6QOSJNPS.js";import{a as L}from"./chunk-EO2LWUCV.js";import{a as w}from"./chunk-6QUXFABH.js";import{a as e,b as h}from"./chunk-TJ55WERY.js";import{c as y}from"./chunk-442635WZ.js";import{a as b,b as x,h as a,j as c}from"./chunk-A24ONYSU.js";import{d as g}from"./chunk-4C7GSA6N.js";import"./chunk-JG7V63GM.js";function I({value:l,id:r,name:u,labelClass:n,inputClass:s,emptyDisplay:d="[empty]",disableKeys:S}){let t=a(0),i=a(l.peek()),p=a(l.peek()),m=x(null),f=!1;return b(()=>{t.value===1&&m.current?.focus()}),c(()=>{t.value===1&&(f=!1)}),t.value===0?e("span",{class:l.value?n:`${n} italic`,onClick:()=>t.value=1,children:l.value||d}):e("input",{type:"text",value:i,ref:m,class:s,id:r,name:u,onInput:o=>{f||(i.value=o.currentTarget.value)},onBlur:()=>{f||(t.value=0,p.value=i.value,l.value=i.value)},onKeyUp:o=>{S||(o.key==="Escape"?(f=!0,i.value=p.value,t.value=0):o.key==="Enter"&&(i.value=o.currentTarget.value,p.value=o.currentTarget.value,t.value=0,l.value=o.currentTarget.value))}})}function v({size:l=6}){return e("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",class:`w-${l} h-${l}`,fill:"currentColor",children:e("use",{href:`${y("/sprites.svg")}#local`})})}function K({db:{name:l,id:r,size:u,path:n}}){let s=a(l),d=r===n?h(r):r;return c(()=>{s.value&&s.value!==l&&fetch(new URL("/api/local",import.meta.url),{method:"POST",body:JSON.stringify([r,s.value]),headers:{"Content-Type":"application/json"}})}),e("li",{class:"flex items-center border rounded p-2 hover:bg-gray-200 hover:dark:bg-gray-800",children:[e("a",{href:`/local/${d}`,children:e("div",{class:"p-2",children:e(v,{size:12})})}),e("div",{class:"flex-grow-0 overflow-hidden px-2",children:[e(I,{value:s,labelClass:"block font-semibold cursor-text w-full hover:bg-gray-300 hover:dark:bg-gray-700 rounded select-none",inputClass:"bg-gray-50 border border-gray-300 text-gray-900 rounded focus:ring-blue-500 focus:border-blue-500 px-2 block w-full dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",emptyDisplay:"[unnamed]"}),e("a",{href:`/local/${d}`,children:[e("div",{class:"text-gray-600 dark:text-gray-400 text-sm",children:k(u)}),e("div",{class:"overflow-ellipsis overflow-hidden text-sm text-gray-600 dark:text-gray-400",children:r})]})]})]})}function E({stores:l}){let r=a(!1);return l?e(g,{children:[e(L,{open:r}),e("div",{children:[e("h1",{class:"text-xl font-bold py-2",children:"Local"}),e("ul",{class:"space-y-2",children:l.map((u,n)=>e(K,{db:u},n))}),e("div",{class:"w-full my-2 md:w-auto flex flex-col md:flex-row space-y-2 md:space-y-0 items-stretch md:items-center justify-end md:space-x-3 flex-shrink-0",children:e(w,{onClick:()=>r.value=!0,children:"Add local store"})})]})]}):null}export{E as default};
